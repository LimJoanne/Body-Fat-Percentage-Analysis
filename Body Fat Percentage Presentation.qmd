---
title: "Body Fat Percentage Presentation"
subtitle: "Group 013E01"
author: "Joanne Lim, John Fu, Haoyuan Gao, Zhenchen Yi"
format: 
  revealjs:
    auto-slide: 20000
    embed-resources: true
    css: custom.css
---

### Data Description

-   Accurately body fat measurement is vital but often inconvenient and expensive
-   Can we use simpler measurements like height, weight, and circumferences for estimates?
-   The data set [bodyfat](https://dasl.datadescription.com/datafile/bodyfat) contains body fat percentages and other related measurements for 250 men. These measurements, which include height, weight and various body circumferences, were collected to explore alternatives to underwater body fat assessments.

```{r, warning = FALSE, message = FALSE}
library(tidyverse)
library(ggplot2)
bodyfat <- read.table("bodyfat.txt", header = TRUE)
glimpse(bodyfat)
library(stats)
```


```{r}
model <- lm(Pct.BF ~ ., data = bodyfat)

summary(model)$coefficients[,4]
```

```{r}
# Get the p-values from the model summary
p_values <- summary(model)$coefficients[,4]

# Remove the p-value for 'Density'
p_values <- p_values[!names(p_values) %in% c("Density")]

# Order the variables by p-value and get the first 3
top_vars <- names(sort(p_values))[1:5]

print(top_vars)

```



---

### Model Selection 

```{r,warning=FALSE, message=FALSE}
library(GGally)
GGally::ggpairs(bodyfat) + theme_bw()
```


```{r, warning =FALSE, message=FALSE}
library(ggplot2)
library(tidyr)

# Reshape data
long_bodyfat <- bodyfat %>%
  pivot_longer(cols = -Pct.BF, names_to = "variable", values_to = "value")

# Plot
p <- ggplot(long_bodyfat, aes(x = Pct.BF, y = value)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "blue") +
  facet_wrap(~ variable, ncol = 5) +
  theme_bw()

print(p)
```


```{r}
M0 = lm(Pct.BF ~ ., data = bodyfat) #full model
M1 = lm(Pct.BF ~ 1, data = bodyfat) #null model

step.back.aic = step(M0,
                     direction = "backward",
                     trace = FALSE)
step.fwd.aic = step(M1, scope = list(lower = M1, upper = M0),
                    direction = "forward", trace = FALSE)

summary(step.back.aic)
summary(step.fwd.aic)
```

```{r}
bodyfat <- bodyfat %>% 
  filter(Pct.BF > 0) %>%
  mutate(lpct_bf = log(Pct.BF))

lm2 <- lm(Pct.BF ~ Age + Ankle + Bicep + Weight, data = bodyfat)
summary(lm2)
```

```{r}
#log linear
lm3 <- lm(Pct.BF ~ Age + Abdomen, data = bodyfat)
summary(lm3)
```

```{r}
#linear log

# Transforming the variables
bodyfat <- bodyfat %>%
  mutate(log_age = log(Age),
         log_abdomen = log(Abdomen))

# Fitting the linear-log model
lm_linear_log <- lm(Pct.BF ~ log_age + log_abdomen, data = bodyfat)

# Getting the summary
summary(lm_linear_log)

```

```{r}
#log-log
lm_log_log <- lm(lpct_bf ~ log_age + log_abdomen, data = bodyfat)

# Getting the summary
summary(lm_log_log)
```

```{r}
library(sjPlot)
tab_model(lm1, pollut_step,
          dv.labels = c("Full", "Backward"),
          show.ci = F, show.aic=T)
```




